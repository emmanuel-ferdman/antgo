"use strict";(self["webpackChunkantgo_web"]=self["webpackChunkantgo_web"]||[]).push([[2,769],{4002:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var i=function(){var e=this,t=e._self._c;return t("b-container",{staticStyle:{"margin-top":"30px","max-width":"80%"}},[t("b-row",[t("b-jumbotron",{staticStyle:{width:"100%"},attrs:{header:e.title,lead:e.description}})],1),t("b-row",[t("b-col",[t("b-card",{staticClass:"mt-6",attrs:{header:"输入信息"}},[t("b-container",e._l(e.input_info,(function(a,i){return t("b-row",{key:i},["image"==a["type"]?t("b-col",{staticStyle:{"margin-top":"20px"}},[t("h4",[t("b-badge",{staticStyle:{"font-weight":"300"}},[e._v(e._s(a["name"]))])],1),t("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[a["has_interactive"]?t("div",{staticStyle:{width:"100%",height:"400px",position:"relative","border-style":"solid","border-width":"1px"},attrs:{id:a["name"]}}):t("b-img",{staticStyle:{"max-width":"512px","border-style":"solid","border-width":"1px"},attrs:{src:a["path"],id:a["name"]}})],1),t("b-form-file",{attrs:{state:Boolean("finish"==a["status"]),placeholder:"拖拽文件至此...","drop-placeholder":"Drop file here...",accept:".jpg, .png, .jpeg","browse-text":"打开"},on:{input:function(t){return e.uploadfile(i)}},model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"input['value']"}}),t("div",{staticClass:"mt-3"},[e._v("上传文件: "+e._s("finish"==a["status"]?a["value"].name+" 完成":""))])],1):e._e(),"video"==a["type"]?t("b-col",{staticStyle:{"margin-top":"20px"}},[t("h5",[e._v(e._s(a["name"]))]),t("video",{attrs:{src:a["path"],controls:""}}),t("b-form-file",{attrs:{state:Boolean("finish"==a["status"]),placeholder:"拖拽文件至此...","drop-placeholder":"Drop file here...",accept:".mp4","browse-text":"打开"},on:{input:function(t){return e.uploadfile(i)}},model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"input['value']"}}),t("div",{staticClass:"mt-3"},[e._v("上传文件: "+e._s("finish"==a["status"]?a["value"].name+" 完成":""))])],1):e._e(),"text"==a["type"]?t("b-col",[t("b-input-group",{staticClass:"mt-3",attrs:{prepend:a["name"]}},[t("b-form-input",{model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"input['value']"}})],1)],1):e._e(),"slider"==a["type"]?t("b-col",{staticStyle:{"margin-top":"20px"}},[t("h5",[e._v(e._s(a["name"])+" "+e._s(a["value"]))]),t("b-input-group",{staticClass:"mt-3",attrs:{prepend:a["min"],append:a["max"]}},[t("b-form-input",{attrs:{type:"range",min:a["min"],max:a["max"]},model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"input['value']"}})],1)],1):e._e(),"checkbox"==a["type"]?t("b-col",{staticStyle:{"margin-top":"20px"}},[t("b-form-checkbox",{attrs:{value:"1","unchecked-value":"0"},model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"input['value']"}},[e._v(e._s(a["name"]))])],1):e._e(),"select"==a["type"]?t("b-col",{staticStyle:{"margin-top":"20px"}},[t("h5",[e._v(e._s(a["name"]))]),t("b-form-select",{attrs:{options:a["options"]},model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"input['value']"}})],1):e._e()],1)})),1)],1)],1),t("b-col",[t("b-card",{staticClass:"mt-6",attrs:{header:"输出信息"}},[e.iserror?t("div",[t("b-alert",{attrs:{show:""}},[e._v(e._s(e.error_message))])],1):e.iswaiting?t("div",[t("count-down")],1):t("div",[t("b-container",e._l(e.output_info,(function(a,i){return t("b-row",{key:i},["image"==a["type"]?t("b-col",[t("h4",[t("b-badge",{staticStyle:{"font-weight":"300"}},[e._v(e._s(a["name"]))])],1),t("div",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center"}},[t("div",[a["interactive"]?t("div",{staticStyle:{width:"400px",height:"400px","border-style":"solid","border-width":"1px"},attrs:{id:a["name"]}}):t("b-img",{staticStyle:{"max-width":"512px","border-style":"solid","border-width":"1px"},attrs:{src:a["value"],id:a["name"]}})],1)])]):e._e(),"video"==a["type"]?t("b-col",[t("h3",[t("b-badge",[e._v(e._s(a["name"]))])],1),t("video",{attrs:{src:a["value"],controls:""}})]):e._e(),"text"==a["type"]?t("b-col",[t("b-input-group",{staticClass:"mt-3",attrs:{prepend:a["name"]}},[t("b-form-input",{attrs:{disabled:""},model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"output['value']"}})],1)],1):e._e(),"number"==a["type"]?t("b-col",[t("b-input-group",{staticClass:"mt-3",attrs:{prepend:a["name"]}},[t("b-form-input",{attrs:{type:"number",disabled:""},model:{value:a["value"],callback:function(t){e.$set(a,"value",t)},expression:"output['value']"}})],1)],1):e._e()],1)})),1)],1)])],1)],1),t("b-row",{staticStyle:{"margin-top":"50px"}},[t("b-button",{staticStyle:{width:"100px"},attrs:{variant:"primary"},on:{click:function(t){return e.submit()}}},[e._v("提交")])],1)],1)},n=[],o=a(9773),s=a.n(o),r=(a(1769),{name:"Demo",data(){return{title:"",demo:"",description:"",input_info:[],output_info:[],image_meta_info:{},iswaiting:!1,iserror:!1,error_message:""}},mounted:function(){this.$route.params.name&&(this.demo=this.$route.params.name);var e=this;e.axios.get("/antgo/api/demo/query_config/",{params:{demo:e.demo}}).then((function(t){for(var a in e.input_info=t.data["input"],e.input_info)e.input_info[a]["has_interactive"]=!1,Object.keys(e.input_info[a].interactive).length>0&&(e.input_info[a]["has_interactive"]=!0);e.title=t.data["title"],e.description=t.data["description"]})).catch((function(e){console.log(e)}))},methods:{uploadfile:function(e){this.input_info[e]["status"]="uploading";var t=new FormData;t.append("file",this.input_info[e].value);var a=this;a.axios.post("/antgo/api/demo/upload/",t).then((t=>{a.input_info[e]["status"]="finish",a.input_info[e]["path"]=t.data["path"],a.$forceUpdate(),"image"==a.input_info[e]["type"]&&Object.keys(a.input_info[e]["interactive"]).length>0&&(a.initMap(a.input_info[e]["name"],t.data["path"],t.data["height"],t.data["width"]),a.setMode(a.input_info[e]["name"],a.input_info[e]["interactive"]["mode"],a.input_info[e]["interactive"]["num"]))}))},submit:function(){this.iswaiting=!0,this.iserror=!1;var e={input:[],element:[],demo:this.demo};for(var t in this.input_info)"image"==this.input_info[t]["type"]||"video"==this.input_info[t]["type"]?e["input"].push(this.input_info[t]["path"]):e["input"].push(this.input_info[t]["value"]);for(let c in Object.keys(this.image_meta_info)){let t=Object.keys(this.image_meta_info)[c];var a=[],i=this.image_meta_info[t]["feature_layer"].getAllFeatures();for(var n in i)if("RECT"==i[n].type){var o=i[n].shape.width,s=i[n].shape.height,r=i[n].shape.x,l=i[n].shape.y;a.push({data:[r,l,r+o,l+s],type:"RECT"})}else if("POINT"==i[n].type)a.push({data:[i[n].shape.x,i[n].shape.y],type:"POINT"});else if("POLYGON"==i[n].type){var u=[];for(var p in i[n].shape.points)u.push([i[n].shape.points[p].x,i[n].shape.points[p].y]);a.push({data:u,type:"POLYGON"})}else"LINE"==i[n].type&&a.push({data:[[i[n]["shape"]["start"].x,i[n]["shape"]["start"].y],[i[n]["shape"]["end"].x,i[n]["shape"]["end"].y]],type:"LINE"});e["element"].push({name:t,value:a,mode:this.image_meta_info[t]["mode"]})}var m=this;let d=new FormData;d.append("query",JSON.stringify(e)),m.axios.post("/antgo/api/demo/submit/",d).then((function(e){m.output_info=e.data,m.iswaiting=!1,m.$nextTick((()=>{for(let n in e.data){var t=e.data[n]["name"];if("image"==e.data[n]["type"])if(!(t in m.image_meta_info)&&e.data[n]["interactive"])m.initMap(e.data[n]["name"],e.data[n]["value"],e.data[n]["height"],e.data[n]["width"]),m.setMode(e.data[n]["name"],e.data[n]["element"]["mode"],e.data[n]["element"]["num"]);else if(t in m.image_meta_info&&e.data[n]["interactive"]){var a=m.image_meta_info[t]["feature_layer"].getAllFeatures();for(var i in m.initMap(e.data[n]["name"],e.data[n]["value"],e.data[n]["height"],e.data[n]["width"]),m.setMode(e.data[n]["name"],e.data[n]["element"]["mode"],e.data[n]["element"]["num"]),a)m.image_meta_info[t]["feature_layer"].addFeature(a[i])}}}))})).catch((function(e){m.iserror=!0,m.error_message="["+e.response.status.toString()+"]:"+e.response.data.detail})).finally((function(){}))},initMap:function(e,t,a,i){var n=this;const o=new(s().Map)(e,{center:{x:100,y:100},zoom:1e3,mode:"ban",refreshDelayWhenZooming:!0,zoomWhenDrawing:!0,panWhenDrawing:!1,zoomWheelRatio:5,withHotKeys:!1}),r=new(s().Layer.Image)("layer-image",{src:t,width:i,height:a,crossOrigin:!1,position:{x:0,y:0}},{name:"图像层"},{zIndex:5});o.events.on("click",(e=>{console.log("--click--",e)})),o.events.on("drawDone",((t,a,i)=>{if(!(n.image_meta_info[e]["feature_layer"].features.length>=n.image_meta_info[e]["num"]))if("POINT"===t){a["sr"]=5;const t=new(s().Feature.Point)(""+ +new Date,a,{name:"point"},{fillStyle:"#3CB371"});n.image_meta_info[e]["feature_layer"].addFeature(t)}else if("LINE"===t){const t=o.getScale(),i=1/t,r=new(s().Feature.Line)(""+ +new Date,{...a,width:i},{name:"line"},{fillStyle:"rgba(255,255,255,0.5)",strokeStyle:"#3CB371",lineWidth:2,fill:!0});n.image_meta_info[e]["feature_layer"].addFeature(r)}else if("RECT"===t){const t=new(s().Feature.Rect)(""+ +new Date,a,{name:"rect"},{fillStyle:"rgba(255,255,255,0.5)",strokeStyle:"#3CB371",lineWidth:2,fill:!0});n.image_meta_info[e]["feature_layer"].addFeature(t)}else if("POLYGON"===t){const t=new(s().Feature.Polygon)(""+ +new Date,{points:a},{name:"polygon"},{fillStyle:"rgba(255,255,255,0.5)",strokeStyle:"#3CB371",lineWidth:2,fill:!0});n.image_meta_info[e]["feature_layer"].addFeature(t)}})),o.events.on("boundsChanged",(e=>{console.log("--map boundsChanged--")})),o.events.on("featureSelected",(t=>{n.image_meta_info[e]["feature_layer"].removeFeatureById(t.id)})),o.events.on("featureUnselected",(()=>{o.setActiveFeature(null)})),o.events.on("featureUpdated",((e,t)=>{console.log("feature updated")})),o.events.on("featureDeleted",(({id:e})=>{console.log("feature delete")})),o.addLayer(r);const l=new(s().Layer.Feature)("first-layer-feature",{name:"绘制层"},{zIndex:10});o.addLayer(l),n.image_meta_info[e]={},n.image_meta_info[e]["gmap"]=o,n.image_meta_info[e]["image_layer"]=r,n.image_meta_info[e]["feature_layer"]=l,n.image_meta_info[e]["mode"]=""},setMode:function(e,t,a){var i;switch(this.image_meta_info[e]["gmap"].setMode(t),this.image_meta_info[e]["mode"]=t,this.image_meta_info[e]["num"]=a,t){case"POINT":i={fillStyle:"#9370DB",strokeStyle:"#f00"},this.image_meta_info[e]["gmap"].setDrawingStyle(i);break;case"LINE":i={strokeStyle:"#FF0000",lineJoin:"round",lineCap:"round",lineWidth:5,arrow:!1},this.image_meta_info[e]["gmap"].setDrawingStyle(i);break;case"POLYLINE":i={strokeStyle:"#FF1493",lineJoin:"round",lineCap:"round",lineWidth:1},this.image_meta_info[e]["gmap"].setDrawingStyle(i);break;case"RECT":i={strokeStyle:"#f00",lineWidth:1},this.image_meta_info[e]["gmap"].setDrawingStyle(i);break;case"POLYGON":i={strokeStyle:"#00f",fillStyle:"#0f0",globalAlpha:.3,lineWidth:1,fill:!0,stroke:!0},this.image_meta_info[e]["gmap"].setDrawingStyle(i);break;case"TEXT":i={fillStyle:"#00f",lineWidth:30},this.image_meta_info[e]["gmap"].setDrawingStyle(i);break;default:break}}}}),l=r,u=a(1001),p=(0,u.Z)(l,i,n,!1,null,"4797e7fc",null),m=p.exports},1769:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("b-container",{staticStyle:{width:"400px","margin-top":"50px"},attrs:{fluid:""}},[t("b-row",{staticClass:"my-1"},[t("b-col",{attrs:{sm:"3"}},[t("label",[e._v("用户名")])]),t("b-col",{attrs:{sm:"9"}},[t("b-form-input",{attrs:{type:"text"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1),t("b-row",{staticClass:"my-1"},[t("b-col",{attrs:{sm:"3"}},[t("label",[e._v("密码")])]),t("b-col",{attrs:{sm:"9"}},[t("b-form-input",{attrs:{type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),t("b-row",[t("b-col",{attrs:{sm:"6"}},[t("b-button",{attrs:{variant:"primary"},on:{click:e.login}},[e._v("登录")])],1),t("b-col",{attrs:{sm:"6"}},[t("b-button",{attrs:{variant:"primary"},on:{click:e.logout}},[e._v("登出")])],1)],1)],1)},n=[],o={name:"Login",data(){return{username:"",password:""}},methods:{login:function(){var e=this;e.axios.get("/antgo/api/user/login/",{params:{user_name:this.username,user_password:this.password}}).then((function(t){e.$router.push({path:"/"})})).catch((function(e){console.log(e)}))},logout:function(){var e=this;e.axios.post("/antgo/api/user/logout/").then((function(t){e.username="",e.password=""})).catch((function(e){console.log(e)}))}}},s=o,r=a(1001),l=(0,r.Z)(s,i,n,!1,null,"b0da7cec",null),u=l.exports}}]);
//# sourceMappingURL=2.1ebc3722.js.map